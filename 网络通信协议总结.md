# 1.UDP协议
传输层里有两个重要的协议，一个是TCP传输控制协议，一个是UDP用户数据报协议。

**TCP和UDP有哪些区别**

TCP是面向连接的，而UDP是面向无连接的。所谓的面向连接，就是在互通之前，面向连接的协议会先建立连接。比如TCP会三次握手，而UDP不会。
而所谓的建立连接，是为了在客户端和服务端维护连接，而建立一定的数据结构来维护双方的交互状态，用这样的数据结构来保证面向连接的特性。

例如TCP提供可靠交付，通过TCP连接传输的数据，无差错、不丢失、不重复、按序到达。IP包是没有任何可靠性保证的，一旦发出去就听天由命了，UDP就是继承了IP包的特性，不保证不丢失，也不保证按序到达。

另外TCP是面向字节流的，发送的时候是一个流，没头没尾。IP包则是一个个的包，UDP继承了IP的特性，基于数据报的，也是一个个的发，一个个的收。

TCP还是有拥塞控制的，当它意识到丢包了或者网络环境变差了，会根据情况调整自己的行为，看看是不是发的太快，要不要慢点。而UDP就不会，让我发，我就发，管他是不是包丢了网堵了。

TCP是有状态的服务，可以理解为有思想的，会精确的记录发送了没有，接收了没有，发送到哪个了，应该接收哪个了。而UDP则是无状态服务，不会记录这些信息。

打一个比方，如果说MAC层定义了本地局域网的传输行为，IP层定义了整个网络端到端的传输行为，这两层基本定义了如下规则：网络传输是以包为单位的，二层叫帧，网络层叫包，传输层叫段，笼统的都称为包。
包单独传输，自行选路，不保证到达。UDP完全继承了这些特性，几乎没有自己的特殊改造。

UPD包头，有源端口号，目标端口号，基本就没有其他的了，只剩下UDP长度和校验和这种数据。相比TCP头来说，简单的一塌糊涂。

UDP有以下特点：
* 结构简单。相信网络通路容易送达，不容易被丢弃。
* 没有连接。虽然有端口号，但是谁都可以给它传数据，它也可以给任何人传数据。
* 没有调控。不会根据网络情况进行发包的拥塞控制。

UDP的三大使用场景：
* 需要资源少，在网络情况好的内网，或者对丢包不敏感的应用。
* 不需要一对一建立连接沟通，而是可以广播的应用(DHCP动态主机配置协议)
* 需要快速处理，时延低，可容忍少量丢包，但要求不能自动降低发包频率的时候。

UPD几个应用举例：
* 网页或APP的访问。QUIC(快速UDP互联网连接)是谷歌推出的基于UDP改进的通信协议，目的是降低网络通信延迟。QUIC在应用层上会自己实现快速建立连接，减少重传时延，自适应拥塞控制。
* 流媒体协议。比如直播应用，在网络不好的时候，应该有选择的丢帧，因此很多都基于UDP实现了自己的视频传输协议。
* 实时游戏。争分夺秒的高实时性，采用UDP协议能够把丢包的延迟降到最低，减少网络问题对于游戏造成的影响。
* 移动通信领域。由于移动网络协议本身就很复杂，因此采用TCP就多余了。


